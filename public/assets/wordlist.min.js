$.fn.wordlist=function(){return this.each(function(){var t=$(this),n=$('<div class="wordlist-view" />'),i=$('<input type="text" />'),e=$(this).parents(".controls").siblings(".control-label").children("label"),r=0==t.val().length?[]:$.map(t.val().split(","),function(t){return t.trim()}),o=[],l=function(){t.val(r.join(",")),$.each(o,function(t,n){n.remove()}),o=$.map(r,function(t){return $("<span>"+t.trim()+"</span>")}),$.each(o,function(t,n){n.insertBefore(i)})},c=function(n){void 0!=n&&null!=n&&""!=n&&(r.push(n.trim()),l(),t.trigger("wordlist:addedWord",[n]))},a=function(n){r.splice(r.indexOf(n),1),l(),t.trigger("wordlist:deletedWord",[n])};n.insertAfter(t),t.hide(),i.appendTo(n),l(),n.on("click","span",function(t){a($(t.target).text().trim()),l()}),e.click(function(t){t.preventDefault(),i.focus()}),i.on("keypress",function(t){if(13==t.which||44==t.which){var n=i.val().trim();i.val(""),n.length>0&&(t.preventDefault(),t.stopPropagation(),c(n))}})})};