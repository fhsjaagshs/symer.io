$.fn.wordlist=function(){return this.each(function(){var t=$('<div class="wordlist-view" />'),i=$('<input type="text" />'),n=$(this).parents(".controls").siblings(".control-label").children("label"),e=0==$(this).val().length?[]:$.map($(this).val().split(","),function(t){return t.trim()}),r=[],o=function(){$(this).val(e.join(",")),$.each(r,function(t,i){i.remove()}),r=$.map(e,function(t){return $("<span>"+t.trim()+"</span>")}),$.each(r,function(t,n){n.insertBefore(i)})},s=function(t){void 0!=t&&null!=t&&""!=t&&(e.push(t.trim()),o(),$(this).trigger("wordlist:addedWord",[t]))},l=function(t){e.splice(e.indexOf(t),1),o(),$(this).trigger("wordlist:deletedWord",[t])};t.insertAfter($(this)),$(this).hide(),i.appendTo(t),o(),t.on("click","span",function(t){l($(t.target).text().trim()),o()}),n.click(function(t){t.preventDefault(),i.focus()}),i.on("keypress",function(t){if(13==t.which||44==t.which){var n=i.val().trim();i.val(""),n.length>0&&(t.preventDefault(),t.stopPropagation(),s(n))}})})};